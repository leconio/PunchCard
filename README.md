# 声明
- 公司自动打卡神器，仅适用于电脑网页端打卡，用到了爬取脚本技术，解决验证码输入问题。
- 这个项目提供的是一种思路，不适用于所有情况，稍微更改一下代码即可适配。
- 本产品请在合适情况下使用，如遇情况概不负责。

# 简介
## 环境
这个项目部署需要有三个设备，一台服务器当做中转，公司电脑以及你的Android手机。
## 思路
简单的思路就是：公司电脑设置一个定时任务，每天到时间触发脚本，爬去网页信息进行模拟登陆，需要验证码的地方传给中转服务器，然后推送给手机，手机输入验证码之后传给中转服务器，继续传给公司电脑进行接下来的打卡操作。下面用一张图来简单说明：
## 交互图
![架构图][1]
## 流程
1. 公司电脑运行一个定时脚本，Mac和Linux可以使用contrab，简单好用。到早上某个时刻开始爬取打卡网页。
2. 网页爬取用到了selenium技术，爬取到网页，定位到验证码的位置然后截图，把图片传递给中转服务器。
3. 此时打卡电脑与中转服务器建立一个长连接，用于实时获取手机传递回来的真实验证码。
4. 中转服务器通过推送服务（我用的极光推送），把验证码图片和全局唯一标示session推送给手机。
5. 手机把session和验证码回传给中转服务器，普通的网络请求就可以。
6. 中转服务器接收到验证码之后，等待打卡电脑下一次hit，带回验证码进行接下来的打卡操作。
7. 打卡成功之后，把结果通过中转服务器推送给手机，通知打卡成功。
## 目录结构
- `punch.py`为打卡机执行脚本，你可以使用contrab命令来周期性执行他。
- server目录为中转服务器。写好了Dockerfile文件，可以直接部署在容器中。
- PrivatePunch 为Android手机端。放到AndroidStudio里边可以直接Run


  [1]: https://pics-1256269247.cos.ap-guangzhou.myqcloud.com/punchcard.png
